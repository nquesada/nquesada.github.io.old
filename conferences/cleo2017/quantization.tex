%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                   File: OSAmeetings.tex             %
%                  Date: March 21, 2007  MSD          %
%                                                     %
%     For preparing LaTeX manuscripts for submission  %
%       submission to OSA meetings and conferences    %
%                                                     %
%       (c) 2007 Optical Society of America           %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[letterpaper,10pt]{article}
\usepackage{osameet2}
\usepackage{comment}
%% standard packages and arguments should be modified as needed

\usepackage{amsmath,amssymb}


\usepackage[pdftex,colorlinks=true,bookmarks=false,citecolor=blue,urlcolor=blue]{hyperref} %pdflatex

\newcommand{\uu}{\mathcal{U}}
\newcommand{\tr}{\text{tr}}
\newcommand{\pr}[1] {\ket{#1}\bra{#1}}
\newcommand{\sinc}{\text{sinc}}
\newcommand{\cc}{\text{c.c.}}
\newcommand{\ea}{\emph{et al.}}
\newcommand{\poly}{\text{poly}}
\newcommand{\ket}[1]{| #1 \rangle}
\newcommand{\bra}[1]{\langle #1 |}
\newcommand{\braket}[1]{\langle #1 \rangle}
\newcommand{\hc}{\text{H.c.}}
\newcommand{\vac}{\text{\vac}}

\begin{document}
\title{A cautionary tale: why you should not use the electric field to quantize in nonlinear optics}

\author{Nicol\'as Quesada$^1$ and J.E. Sipe $^2$}
\address{$^1$ Department of Physics \& Astronomy, Macquarie University, NSW 2109, Australia \\ $^2$ Department of Physics, University of Toronto, Toronto, ON, M5S1A7, Canada}
%\email{sipe@physics.utoronto.ca}

\begin{abstract}
\input{quantization.abstract}
\end{abstract}

\ocis{190.0190, 270.0270}

\section{Introduction}
An important problem in the study of nonlinear  quantum optics is how to properly quantize the electromagnetic (EM) field in a dielecric.
To canonically quantize a theory one introduces a set of canonical variables with proper canonical commutation relations (CCR) and
writes a Hamiltonian operator that (a) is numerically equal to the energy of the system and (b) when used to generate the Heisenberg equations of motion (HEM) produces precisely the classical equations of motion, which are in our case Maxwell's Equations (MEs). 
%Choosing the right canonical variables for a nonlinear dielectric is a nontrivial problem that has been studied since the early days of quantum mechanics \cite{born}.
Hillery and Mlodinow\cite{hillery} have shown that using as canonical variables for a nonlinear dielectric the canonical variables that one obtains for the EM field in vacuum lead to a blatant violation of MEs. In this contribution we generalize this result by showing that any expression in which the electric field is written as a linear combination of bosonic creation and annihilation operators  will lead to results that are inconsistent with MEs, and furthermore that when applied to photon generation processes such as SPDC and photon transduction processes such as frequency conversion they lead to incorrect expressions for the respective rates at which twin photons are generated or at which photons are converted.

\section{Quantizing the electromagnetic field in a nonlinear dielectric}
The nonlinear dielectric Hamiltonian in terms of the magnetic field $\mathbf{B}$ and the electric field $\mathbf{E}$ or displacement $\mathbf{D}$ is
\begin{align}\label{hamil}
H=\int d^3 \mathbf{r} \left(\frac{\mathbf{B}^2}{2 \mu_0}+  \epsilon_0 \mathbf{E} \cdot \left\{ \frac{1+\chi^{(1)}}{2}\mathbf{E} + \sum_{n \geq 2} \frac{n}{n+1}  \mathbf{\chi}^{(n)} : \mathbf{E}^n \right\} \right)=\int d^3\mathbf{r} \left(\frac{\mathbf{B}^2}{2 \mu_0} +\sum_{n\geq 1}\frac{1}{n+1}\mathbf{D}\cdot \mathbf{\eta}^{(n)} : \mathbf{D}^n\right)
\end{align}
where $\mathbf{\chi}^{(n)}$ are the usual susceptibility tensors and the $\mathbf{\eta}^{(n)}$ are the tensors used to expand $\mathbf{E}=\sum_{n} \mathbf{\eta}^{(n)} :\mathbf{D}^n$. These tensors can be easily related\cite{drummond}, for example $\mathbf{\eta}^{(1)}=\epsilon_0^{-1}(1+\mathbf{\chi}^{(1)})^{-1}$ and $\mathbf{\eta}^{(2)}=-\epsilon_0 \mathbf{\eta}^{(1)} \chi^{(2)}: \mathbf{\eta}^{(1)} \mathbf{\eta}^{(1)}$. They can also be easily related to the $\Gamma$ tensors introduced in Ref. \cite{sipe} to expand the macroscopic polarization of the material $\mathbf{P}=\sum_{n} \Gamma^{(n)}: \mathbf{D}^n$ as follows: $\epsilon_0 \mathbf{\eta}^{(1)}=1-\Gamma^{(1)}$ and $\epsilon_0\mathbf{\eta}^{(n)}=-\Gamma^{(n)}, n>1$.
To quantize the theory Hillery and Mlodinow give the CCR $[\mathbf{A}_j(\mathbf{r}),\Pi_k(\mathbf{r}')]=i \hbar \delta_{jk}^{\text{tr}}(\mathbf{r}-\mathbf{r}')$ where $\Pi=-\mathbf{D}$, $\nabla \times \mathbf{A}=\mathbf{B}$, and $\delta^{\text{tr}}$ is the transverse $\delta$ distribution. One can write the commutation relation more conveniently in terms of the physical fields of the theory by taking the curl with respect to $\mathbf{r}$ in Hillery and Mlodinow's CCR to obtain $[D^i(\mathbf{r}),B^j(\mathbf{r'})]=i\hbar \epsilon^{ijk} \frac{\partial}{\partial r^l} \delta(\mathbf{r}-\mathbf{r}')$ where $\epsilon^{ijk}$ is the Levi-Civita symbol. This last equation is precisely the CCR introduced by Sipe \ea \cite{sipe}. The fact that $\mathbf{D}$ and $\mathbf{B}$ are the fields that appear in the CCR implies that these fields are the ones that ultimately will be written as linear combinations of bosonic creation and annihilation operators.

\section{What goes wrong with the electric field?}
Let us assume now that one tries to use $\mathbf{E}$ and $\mathbf{B}$ as the canonical fields and writes them as linear combinations of bosonic creation operators, labelled by some index $q$ that could correspond, for example, to a wave vector and polarization. More generally, these bosonic operators are chosen in such a way that they diagonalize the linear part of the Hamiltonian (which is the part of the Hamiltonian \emph{quadratic} in the fields). We write very generally
\begin{align}\label{wrong}
\mathbf{E}=\poly_1(a_q,a_q^\dagger) \text{ and } \mathbf{B}=\poly_1(a_q,a_q^\dagger)
\end{align} 
where $\poly_n(x)$ indicates a polynomial of degree $n$ in the variables $x$, in particular, $\poly_1(a_q,a_q^\dagger)$ is a linear combination of the creation and annihilation operators and $[a_q,a_{q'}^\dagger]=\delta_{q,q'}$. Now let us write Faraday's law and the HEM for $\mathbf{B}$
\begin{align}
\nabla \times \mathbf{E} = -\partial_t \mathbf{B} = -[\mathbf{B},H] /(i \hbar)
\end{align}
Using Eq. (\ref{wrong}) we have that the LHS is a polynomial of degree one in the $a_q$ and $a_q^\dagger$. As for the RHS and assuming for simplicity only a third order nonlinearity and the Hamiltonian in Eq. (\ref{hamil}) we have $[\poly_1(a_q,a_q^\dagger),(\poly_1 (a_q,a_q^\dagger)^3]= [\poly_1(a_q,a_q^\dagger),\poly_3 (a_q,a_q^\dagger)]=\poly_2 (a_q,a_q^\dagger)$. This shows that one cannot take the electric field to be a linear combination of $a_q$ and $a_q^\dagger$ and expect to satisfy MEs. This difficulty has already been pointed out for the specific strategy of taking $\mathbf{E}$ to be plane waves for the EM field in vacuum\cite{hillery}, where that strategy leads to fields that propagate at the speed of light in vacuum inside the dielectric \cite{drummond}. But it is clear that \emph{any} strategy based on an $\mathbf{E}$ linear in $a_q$ and $a_q^\dagger$ is problematic. This fact was pointed out for the case where the linear combination taken is the expansion of $\mathbf{E}$ in terms of plane waves for the EM field in vacuum  \cite{hillery}. This expansion not only leads to mathematical inconsistencies like the one just presented but also predicts that the fields propagate at the speed of light in vacuum inside the dielectric\cite{drummond}. \\
Nonetheless, one might hope that if a treatment of the field correct in the linear limit is substituted in a cavalier way into the nonlinear part of the Hamiltonian, a negligible mistake would be made since the nonlinear interaction is weak. \emph{This is not the case, since the quadratic part of the Hamiltonian in terms of the correct $\mathbf{E}$ in Eq. (\ref{hamil}) contributes cubic and higher order terms in the Hamiltonian in terms of $\mathbf{D}$ (or equivalently $a_q$ and $a_q^\dagger$)} that renormalize the nonlinear interaction. If one insists on writing $\mathbf{E}_{\text{linear}}=(1+\chi^{(1)})^{-1} \mathbf{D}/\epsilon_0=\poly_1(a_k,a_k^\dagger)$, substitutes it in $H$ in terms of $\mathbf{E}$ or $\mathbf{D}$, and uses the relationship between the $\mathbf{\chi}$ and the $\mathbf{\eta}$ one finds that the Hamiltonians are only identical up to quadratic order in the bosonic operators. Past this point the $n^{\text{th}}$ order terms differ by a factor $n$. This will imply that if one uses the incorrect $\textbf{E}_{\text{linear}}$ in $H$ one will overestimate the contribution of the  $n^{\text{th}}$ order nonlinear term by a factor of $n$, due to the fact that one is ignoring the proper constitutive relation between $\mathbf{E}=\sum_{n} \mathbf{\eta}^{(n)}: \mathbf{D}^n$. Using the correct \emph{nonlinear} constitutive relation and assuming a phase matched $\chi_2$ process between modes $A$, $B$, and $C$, one would have an interaction Hamiltonian of the form
\begin{align}\label{eq}
H_I(t)=\hbar \theta' \int dk_A dk_B dk_C \Phi(k_A,k_b,k_c) a_A^\dagger(k_A) a_B^\dagger(k_B) a_C (k_C) e^{i (\omega_A(k_A)+\omega_B(k_B)-\omega_C(k_C)) t}+\hc
\end{align}
whereas if one used $\mathbf{E}_{\text{linear}}$ one would have a Hamiltonian that is a factor of two larger than this.
If one assumes that mode $C$ is injected with a coherent state with $ N \gg 1$ photons then $a_C(k_C) \sim \braket{a_C(k_C)}=\sqrt{N} \alpha(k_C)$ and one will generate twin beams in modes $A$ and $B$. If one furthermore assumes that the process is phase matched in such a way that the joint spectral amplitude of the process is separable and that time ordering corrections can be ignored \cite{nico1} then the output state in modes $A$ and $B$ is $\ket{\psi_{AB}}=\exp\left(i \theta \sqrt{N}\int dk_A dk_B f(k_A) j(k_b)  a_A^\dagger(k_A) a_B^\dagger(k_B)+\hc\right) \ket{\text{vac}}$.
The mean number of photons in the twin beams is $\braket{n_{A/B}}=\sinh^2(\theta \sqrt{N})$. If one instead had incorrectly used $\textbf{E}_{\text{linear}}$ one would find a mean number photons that for $\theta \sqrt{N}\gg 1$ is $\braket{n_{A/B \text{ linear}}}=4\braket{n_{A/B}}^2$.
Under similar assumptions but now for a frequency conversion process where now $a_B(k_B) \sim \braket{a_B(k_B)}=\sqrt{N} \alpha(k_B)$ one finds that the unitary connecting input and output is $\exp\left(i \theta \sqrt{N}\int dk_A dk_C r(k_A) t(k_C)  a_A^\dagger(k_A) a_C(k_C)+\hc\right)$\cite{nico2}. If a single photon with spectrum $r(k_A)$ was sent to the medium together with the pump field, it would be converted to a single photon in mode $C$ with probability $p_{A \to C}=\sin^2 (\theta \sqrt{N})$. If one incorrectly used $\textbf{E}_{\text{linear}}$ this probability would be $p_{A \to C (\text{linear})}=\sin^2 (2\theta \sqrt{N})=4 p_{A \to C}(1-p_{A \to C})$.
\begin{thebibliography}{99}
%\bibitem{born} M. Born and L. Infeld, ``On the quantum theory of the electromagnetic field'',  Proc. R. Soc. A {\bf 143}, 410 (1934).
\bibitem{hillery} M. Hillery, \emph{et al.}, ``Quantization of electrodynamics in nonlinear media'', Phys. Rev. A {\bf 30}, 1860 (1984).
\bibitem{drummond} P.D. Drummond and M. Hillery, \emph{The Quantum Theory of Nonlinear Optics}, (Cambridge, 2014).
\bibitem{sipe} J.E. Sipe, \emph{et al.}, ``Effective field theory for the nonlinear optical properties of photonic crystals'', Phys. Rev. E {\bf 69}, 016604 (2004).
\bibitem{nico1} N. Quesada and J.E. Sipe, ``Time-ordering effects in the generation of entangled photons using nonlinear optical processes'', Phys. Rev. Lett. {\bf 114} , 093903 (2015).
\bibitem{nico2} N. Quesada \ea, ``High efficiency in mode-selective frequency conversion'', Opt. Lett. {\bf 41}, 364-367 (2016).
\end{thebibliography}
\end{document}
